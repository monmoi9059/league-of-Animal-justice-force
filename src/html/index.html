<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self'; object-src 'none';">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="manifest" href="manifest.json">
    <title>League of Animal Justice Avenger Force: Operation Dumpster Fire</title>
    <!-- CSS_INJECTION_POINT -->
</head>
<body>

    <div id="gameContainer">
        <!-- Canvas size will be set by JS -->
        <canvas id="gameCanvas"></canvas>
        <div id="errorOverlay"></div>
        <div id="debugHUD">Initializing...</div>

        <!-- HUD -->
        <div id="gameUI">
            <div class="stat-box">HERO: <span id="charName" style="color:#00ff41">IRON MUTT</span></div>
            <div class="stat-box">HP: <span id="healthDisplay" style="color:#ff00de">‚ù§‚ù§‚ù§</span></div>
            <div class="stat-box">LIVES: <span id="livesDisplay" style="color:yellow">3</span></div>
            <div class="stat-box">RESCUES: <span id="rescueDisplay">0</span></div>
            <div class="stat-box">SCORE: <span id="scoreDisplay">0</span></div>
            <div class="stat-box">LEVEL: <span id="levelDisplay">1</span></div>
        </div>

        <div id="bossHealthContainer">
            <div id="bossHealthBar"></div>
        </div>

        <!-- MAIN MENU -->
        <div id="menuOverlay" class="overlay-screen">
             <!-- Title in Menu -->
             <h1 style="font-size: 32px; color: #00ff41; margin-bottom: 40px; text-align: center; max-width: 80%;">
                LEAGUE OF ANIMAL JUSTICE<br>AVENGER FORCE
            </h1>
            <button onclick="window.enterLobby()">DEPLOY SQUAD</button>
            <button onclick="window.viewRoster()">VIEW TEAM</button>
        </div>

        <!-- ROSTER MENU -->
        <div id="rosterOverlay" class="overlay-screen">
            <button onclick="window.returnToMenu()" style="position: absolute; bottom: 30px;">BACK</button>
        </div>

        <!-- LOBBY MENU -->
        <div id="lobbyOverlay" class="overlay-screen" style="display: none;">
            <h2 style="color: #00ff41; margin-bottom: 20px;">SQUAD SETUP</h2>
            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                <div class="stat-box" style="width: 150px; height: 100px; display: flex; flex-direction: column; justify-content: center;">
                    <div>PLAYER 1</div>
                    <div id="lobbyStatus1" style="color: #777; margin-top: 10px;">PRESS A / SPACE</div>
                </div>
                <div class="stat-box" style="width: 150px; height: 100px; display: flex; flex-direction: column; justify-content: center;">
                    <div>PLAYER 2</div>
                    <div id="lobbyStatus2" style="color: #777; margin-top: 10px;">PRESS A</div>
                </div>
                <div class="stat-box" style="width: 150px; height: 100px; display: flex; flex-direction: column; justify-content: center;">
                    <div>PLAYER 3</div>
                    <div id="lobbyStatus3" style="color: #777; margin-top: 10px;">PRESS A</div>
                </div>
                <div class="stat-box" style="width: 150px; height: 100px; display: flex; flex-direction: column; justify-content: center;">
                    <div>PLAYER 4</div>
                    <div id="lobbyStatus4" style="color: #777; margin-top: 10px;">PRESS A</div>
                </div>
            </div>
            <p id="lobbyMessage" style="color: #aaa; margin-bottom: 20px;">WAITING FOR PLAYERS...</p>
            <button id="lobbyStartBtn" onclick="window.startGame()" style="display: none;">START MISSION</button>
        </div>

        <!-- LEVEL COMPLETE -->
        <div id="levelCompleteOverlay" class="overlay-screen">
            <h2 style="color: gold; font-size: 40px; margin-bottom: 20px;">AREA SECURED</h2>
            <div style="font-size: 20px; color: #fff; line-height: 1.6;">
                <p>KILLS: <span id="lcKills" style="color: red">0</span></p>
                <p>RESCUES: <span id="lcRescues" style="color: #00ff41">0</span></p>
                <p>TIME BONUS: <span id="lcTime" style="color: yellow">0</span></p>
            </div>
            <button onclick="window.nextLevel()">NEXT MISSION</button>
        </div>

        <!-- GAME OVER / WIN -->
        <div id="gameOverOverlay" class="overlay-screen">
            <h2 id="ovTitle" style="font-size: 50px; color: #00ff41; margin-bottom: 10px;">MISSION FAILED</h2>
            <p id="ovMsg" style="margin-bottom: 30px; font-size: 20px;">The HOA has won.</p>
            <button onclick="window.returnToBase()">RETURN TO BASE</button>
        </div>

        <div class="controls">
            ARROWS/WASD: Move | SPACE: Jump | SHIFT: Sprint | Z: Shoot | X: Special | C: 2nd Attack | DOWN+Z: Down Attack | F: Flex
        </div>

        <!-- Touch Controls -->
        <button id="controlsToggle" class="touch-toggle">üéÆ</button>
        <button id="soundToggle" class="touch-toggle" style="right: 70px;">üîä</button>

        <div id="touchControls" class="touch-overlay" style="display: none;">
            <div class="dpad-area">
                <div class="dpad-row">
                    <button id="btnUp" class="touch-btn dpad-btn">‚ñ≤</button>
                </div>
                <div class="dpad-row">
                    <button id="btnLeft" class="touch-btn dpad-btn">‚óÄ</button>
                    <div class="dpad-spacer"></div>
                    <button id="btnRight" class="touch-btn dpad-btn">‚ñ∂</button>
                </div>
                <div class="dpad-row">
                    <button id="btnDown" class="touch-btn dpad-btn">‚ñº</button>
                </div>
            </div>

            <div class="action-area">
                <div class="action-group-main">
                    <button id="btnShoot" class="touch-btn action-btn large">Z</button>
                    <button id="btnJump" class="touch-btn action-btn large">SPACE</button>
                </div>
                <div class="action-group-sub">
                    <button id="btnSpecial" class="touch-btn action-btn">X</button>
                    <button id="btnSecondary" class="touch-btn action-btn">C</button>
                    <button id="btnFlex" class="touch-btn action-btn">F</button>
                    <button id="btnSprint" class="touch-btn action-btn toggle-btn">RUN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JS_INJECTION_POINT -->

</body>
</html>
